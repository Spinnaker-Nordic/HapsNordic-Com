<style>
  #section__{{ section.id }} {
    grid-template-columns: repeat({{ section.settings.cols_mobile }}, 1fr);
  }

  @media screen and (min-width: 1024px) {
    #section__{{ section.id }} {
      grid-template-columns: repeat({{ section.blocks.size | at_most: section.settings.cols_desktop }}, 1fr);
    }
  }
</style>
<div
  class="section bg-primary-bg color-scheme__{{ section.settings.color_scheme }}"
  style="padding-top: 0 !important; padding-bottom: 0 !important;"
>
  <div
    id="section__{{ section.id }}"
    class="{% if section.settings.mobile_slider %}flex overflow-x-auto scrollbar-hide{% else %}grid{% endif %} section--bleed gap-4 text-primary-text lg:grid"
  >
    {% for block in section.blocks %}
      {% assign this = block.settings %}
      {% assign image = this.image | default: this.collection.image %}
      {% assign url = this.url | default: this.collection.url %}

      <a
        href="{{ url }}"
        class="group relative block rounded overflow-hidden hover:cursor-pointer {% if section.settings.mobile_slider %}max-lg:flex-[90%_0_0]{% endif %}"
      >
        <div class="{{ section.settings.media_aspect }}">
          {# … keep your existing image/placeholder code unchanged … #}
          {{
            image
            | image_url: width: image.width
            | image_tag:
              loading: 'lazy',
              sizes: sizes,
              widths: '150, 180, 210, 240, 270, 300, 330, 410, 490, 570, 650, 730, 810, 890, 970, 1050, 1290, 1530, 1770, 2090, 2410, 2730',
              class: 'object-cover rounded bg-secondary-bg group-hover:scale-[1.025] transition-transform duration-500 ease-in-out'
          }}
        </div>

        <div class="absolute inset-0 flex items-center justify-center before:absolute before:inset-0 before:bg-gradient-to-t before:from-black/30 before:to-transparent before:content-['']">
          <div class="z-10 flex flex-col items-center justify-center gap-4 px-4 text-center">
            <span class="text-4xl font-semibold text-secondary-text">
              {{- this.title | default: this.collection.title | default: 'Collection' -}}
            </span>

            <span class="relative inline-flex h-12 w-12" aria-hidden="true">
              <span
                class="absolute inset-0 m-auto inline-flex h-4/6 w-4/6 animate-horizon-ping rounded-full bg-secondary-button-bg opacity-75"
              ></span>
              <span class="relative inline-flex h-12 w-12 rounded-full bg-secondary-button-bg">
                <span class="absolute inset-0 m-auto h-6 w-6 text-secondary-button-text">
                  {% render 'icons', icon: 'chevron-right' %}
                </span>
              </span>
            </span>
          </div>
        </div>
      </a>
    {% endfor %}
  </div>
</div>

{% schema %}
{
  "name": "Collection list3",
  "settings": [
    {
      "type": "select",
      "id": "media_aspect",
      "label": "Media aspect ratio",
      "options": [
        {
          "value": "aspect-w-1 aspect-h-1",
          "label": "1:1"
        },
        {
          "value": "aspect-w-16 aspect-h-9",
          "label": "16:9"
        },
        {
          "value": "aspect-w-4 aspect-h-6",
          "label": "4:6"
        },
        {
          "value": "aspect-w-4 aspect-h-5",
          "label": "4:5"
        }
      ],
      "default": "aspect-w-1 aspect-h-1",
      "info": "Applies to all media in this section"
    },
    {
      "type": "range",
      "id": "cols_desktop",
      "min": 1,
      "max": 4,
      "step": 1,
      "label": "Max columns on desktop",
      "default": 4
    },
    {
      "type": "checkbox",
      "id": "mobile_slider",
      "label": "Enable carousel on mobile",
      "default": false
    },
    {
      "type": "select",
      "id": "cols_mobile",
      "label": "Number of columns on mobile",
      "options": [
        {
          "value": "1",
          "label": "1 column"
        },
        {
          "value": "2",
          "label": "2 columns"
        }
      ],
      "default": "1",
      "info": "Only applicable if carousel is turned off for mobile"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "default": "background-1",
      "label": "Color Scheme"
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "info": "Defaults to collection"
        },
        {
          "type": "url",
          "id": "url",
          "label": "URL",
          "info": "Defaults to collection"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image",
          "info": "Defaults to collection"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collection list3",
      "blocks": [
        {
          "type": "collection"
        },
        {
          "type": "collection"
        },
        {
          "type": "collection"
        }
      ]
    }
  ]
}
{% endschema %}
